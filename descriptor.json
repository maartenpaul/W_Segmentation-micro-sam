{
    "name": "Segmentation-micro-sam",
    "description": "Performs instance segmentation using Micro-SAM (Segment Anything Model)",
    "container-image": {
        "image": "maartenpaul/w_segmentation-micro-sam",
        "type": "singularity"
    },
    "schema-version": "cytomine-0.1",
    "command-line": "python /app/micro_sam_wrapper.py [CYTOMINE_FLAGS] [PARAMS]",
    "inputs": [
        {
            "id": "cytomine_host",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Cytomine host",
            "set-by-server": true,
            "optional": false,
            "type": "String"
        },
        {
            "id": "cytomine_public_key",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Cytomine public key",
            "set-by-server": true,
            "optional": false,
            "type": "String"
        },
        {
            "id": "cytomine_private_key",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Cytomine private key",
            "set-by-server": true,
            "optional": false,
            "type": "String"
        },
        {
            "id": "cytomine_id_project",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Cytomine project ID",
            "set-by-server": true,
            "optional": false,
            "type": "Number"
        },
        {
            "id": "cytomine_id_software",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Cytomine software ID",
            "set-by-server": true,
            "optional": false,
            "type": "Number"
        },
        {
            "id": "model_type",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Micro-SAM Model Type",
            "description": "Specify the Segment Anything model variant (e.g., vit_t, vit_b, vit_l, vit_h). Check micro-sam documentation for available models.",
            "default-value": "vit_b",
            "set-by-server": false,
            "optional": false,
            "type": "String",
            "value-choices": ["vit_t", "vit_b", "vit_l", "vit_h"]
        },
        {
            "id": "segmentation_mode",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Segmentation Mode",
            "description": "Select the automatic segmentation mode: 'amg' (Automatic Mask Generator) or 'ais' (requires AIS-compatible model).",
            "default-value": "amg",
            "set-by-server": false,
            "optional": false,
            "type": "String",
            "value-choices": ["amg", "ais"]
        },
        {
            "id": "ndim",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Input Dimensionality (ndim)",
            "description": "Specify input data dimensionality (e.g., 2 for 2D/RGB, 3 for 3D). Leave empty to let micro-sam infer (may fail for RGB).",
            "set-by-server": false,
            "optional": true,
            "type": "Number"
        },
         {
            "id": "tile_shape",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Tile Shape (optional)",
            "description": "Shape of tiles for tiled prediction (e.g., '512,512'). If empty, no tiling is used.",
            "set-by-server": false,
            "optional": true,
            "type": "String"
        },
        {
            "id": "halo",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Halo Size (optional)",
            "description": "Overlap between tiles for tiled prediction (e.g., '64,64'). Requires tile_shape.",
            "set-by-server": false,
            "optional": true,
            "type": "String"
        },
        {
            "id": "pred_iou_thresh",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Prediction IoU Threshold (AMG/AIS)",
            "description": "Postprocessing: IoU threshold for filtering predicted masks. Default depends on mode/model.",
             "default-value": 0.88,
            "set-by-server": false,
            "optional": true,
            "type": "Number"
        },
        {
             "id": "stability_score_thresh",
            "value-key": "@ID",
            "command-line-flag": "--@id",
            "name": "Stability Score Threshold (AMG/AIS)",
            "description": "Postprocessing: Stability score threshold for filtering predicted masks. Default depends on mode/model.",
            "default-value": 0.95,
            "set-by-server": false,
            "optional": true,
            "type": "Number"
        }
    ]
}